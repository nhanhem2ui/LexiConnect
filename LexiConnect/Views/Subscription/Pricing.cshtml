@{
    ViewData["Title"] = "Pricing - LexiConnect";
}
@model LexiConnect.Models.ViewModels.PricingViewModel

<head>
    <link rel="stylesheet" href="~/css/Subscription/Pricing.css" />
</head>

<div class="subscription-page">
    <div class="subscription-container">

        <!-- Pricing Header -->
        <div class="pricing-header">
            <div class="pricing-badge">Pricing</div>
            <h1 class="pricing-title">@Model.Title</h1>
            <h2 class="pricing-subtitle">@Model.Subtitle</h2>
            <p class="pricing-description">
                <strong>@Model.Description</strong><br>
                @Model.SubDescription
            </p>
        </div>

        <!-- Pricing Plans -->
        <div class="pricing-plans">
            @foreach (var plan in Model.Plans)
            {
                <div class="pricing-card data-plan-id="@plan.SubscriptionPlan.PlanId">
                    <div class="plan-header">
                        <h3 class="plan-name">@plan.SubscriptionPlan.DisplayName</h3>
                        <p class="plan-description">@plan.SubscriptionPlan.Description</p>

                        <div class="plan-price">
                            <span class="price-currency">$</span>
                            @if (plan.SubscriptionPlan.Price <= 0m)
                            {
                                <span class="price-amount">Free use</span>
                            }
                            else
                            {
                                <span class="price-amount">@plan.SubscriptionPlan.Price.ToString("F2")</span>
                                <span class="price-period">/ @plan.SubscriptionPlan.DurationMonths Month</span>
                            }
                        </div>
                    </div>

                    <ul class="plan-features">
                        @foreach (var feature in plan.Features)
                        {
                            <li>
                                <div class="feature-icon"></div>
                                @feature
                            </li>
                        }
                    </ul>
                    @if (!User.Identity.IsAuthenticated)
                    {
                        <form asp-controller="Auth" asp-action="Signin" method="post" style="margin: 0;">
                            <input type="hidden" name="redirectTo" value="@Url.Action("Pricing", "Subscription")" />
                            <button type="submit" class="plan-button @plan.ButtonClass">
                                Sign in to Subscribe
                            </button>
                        </form>
                    }
                    else
                    {
                        if (plan.IsFree)
                        {
                            <form asp-controller="Subscription" asp-action="Subscribe" method="post" style="margin: 0;">
                                <input type="hidden" name="planId" value="@plan.SubscriptionPlan.PlanId" />
                                <button type="submit" class="plan-button @plan.ButtonClass">
                                    @plan.ButtonText
                                </button>
                            </form>
                        }
                        else
                        {
                            <form asp-controller="Payment" asp-action="CreatePayment" method="post" style="margin: 0;">
                                <input type="hidden" name="amount" value="@plan.SubscriptionPlan.Price" />
                                <input type="hidden" name="orderDescription" value="@plan.SubscriptionPlan.DisplayName" />
                                <button type="submit" class="plan-button @plan.ButtonClass">
                                    @plan.ButtonText
                                </button>
                            </form>
                        }
                    }
                </div>
            }
        </div>

        <!-- Money Back Guarantee -->
        @if (!string.IsNullOrEmpty(Model.MoneyBackGuarantee))
        {
            <div class="guarantee-text">
                @Model.MoneyBackGuarantee
            </div>
        }
    </div>
</div>

<script src="~/js/Subscription/Pricing.js"></script>