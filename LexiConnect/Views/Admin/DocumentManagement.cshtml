@{
    Layout = "_Layout";
    ViewData["Title"] = "Document Management";
}
@model LexiConnect.Models.ViewModels.DocumentManagementViewModel

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Management - LexiConnect</title>
    <link rel="stylesheet" href="~/css/Admin/DocumentManagement.css" />
</head>

<body>
    <div class="dashboard-container">
        <partial name="_Sidebar" />

        <!-- Main Content -->
        <div class="main-content">
            <!-- Page Header -->
            <div class="page-header">
                <div>
                    <h1 class="page-title">Document Management</h1>
                    <p class="page-subtitle">Manage and organize all documents in the system</p>
                </div>
                <!-- Quick Stats -->
                <div class="quick-stats">
                    <div class="stat-card">
                        <span class="stat-number">@Model.TotalDocuments</span>
                        <span class="stat-label">Total Documents</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">@Model.PendingDocuments</span>
                        <span class="stat-label">Pending</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">@Model.FlaggedDocuments</span>
                        <span class="stat-label">Flagged</span>
                    </div>
                </div>
            </div>

            <!-- Controls Section -->
            <div class="controls-section">
                <form method="get" asp-action="DocumentManagement">
                    <div class="controls-row">
                        <div class="search-group">
                            <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="11" cy="11" r="8"/>
                                <path d="M21 21l-4.35-4.35"/>
                            </svg>
                            <input type="text" class="search-input" name="search" 
                                   placeholder="Search documents by title, description, uploader, or course..." 
                                   value="@ViewBag.SearchTerm" />
                        </div>
                    </div>
                    
                    <div class="filter-row">
                        <div class="filter-group">
                            <select class="select-input" name="status" asp-items="ViewBag.StatusFilterList">
                                <option value="">All Status</option>
                            </select>

                            <select class="select-input" name="type" asp-items="ViewBag.TypeFilterList">
                                <option value="">All Types</option>
                            </select>

                            <select class="select-input" name="course" asp-items="ViewBag.CourseFilterList">
                                <option value="">All Courses</option>
                            </select>
                        </div>
                    </div>

                    <div class="sort-row">
                        <div class="sort-group">
                            <label>Sort by:</label>
                            <select class="select-input" asp-for="SortBy" name="sortBy" asp-items="ViewBag.SortByList"></select>

                            <select class="select-input" asp-for="SortOrder" name="sortOrder" asp-items="ViewBag.SortOrderList"></select>

                            <button type="submit" class="btn btn-primary">Apply Filters</button>
                            <a href="@Url.Action("DocumentManagement", "Admin")" class="btn btn-outline">Clear All</a>
                        </div>
                    </div>
                </form>
                
                <div class="results-info">
                    <span>Showing <strong>@Model.Documents.Count()</strong> of <strong>@Model.TotalCount</strong> documents</span>
                    <span>Page @Model.CurrentPage of @Model.TotalPages</span>
                </div>
            </div>

            <!-- Table Container -->
            <div class="table-container">
                @if (Model.Documents?.Any() == true)
                {
                    <table class="documents-table">
                        <thead>
                            <tr>
                                <th>Document</th>
                                <th>Type</th>
                                <th>Uploader</th>
                                <th>Course</th>
                                <th>Status</th>
                                <th>Created</th>
                                <th>Stats</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var document in Model.Documents)
                            {
                                <tr>
                                    <td>
                                        <div class="document-title">
                                            <div class="document-icon">
                                                @switch(document.FileType?.ToLower())
                                                {
                                                    case "pdf":
                                                        <span>📄</span>
                                                        break;
                                                    case "doc":
                                                    case "docx":
                                                        <span>📝</span>
                                                        break;
                                                    case "ppt":
                                                    case "pptx":
                                                        <span>📊</span>
                                                        break;
                                                    default:
                                                        <span>📁</span>
                                                        break;
                                                }
                                            </div>
                                            <div class="title-text">
                                                <h4>
                                                    @document.Title
                                                    @if (document.IsPremiumOnly)
                                                    {
                                                        <span class="premium-indicator" title="Premium Only">💎</span>
                                                    }

                                                    @if (document.IsAiGenerated)
                                                    {
                                                        <br/>
                                                        <span class="ai-indicator" title="AI Generated">
                                                            <svg viewBox="0 0 512 512" width="24" height="24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>ai</title> <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="icon" fill="#000000" transform="translate(64.000000, 64.000000)"> <path d="M320,64 L320,320 L64,320 L64,64 L320,64 Z M171.749388,128 L146.817842,128 L99.4840387,256 L121.976629,256 L130.913039,230.977 L187.575039,230.977 L196.319607,256 L220.167172,256 L171.749388,128 Z M260.093778,128 L237.691519,128 L237.691519,256 L260.093778,256 L260.093778,128 Z M159.094727,149.47526 L181.409039,213.333 L137.135039,213.333 L159.094727,149.47526 Z M341.333333,256 L384,256 L384,298.666667 L341.333333,298.666667 L341.333333,256 Z M85.3333333,341.333333 L128,341.333333 L128,384 L85.3333333,384 L85.3333333,341.333333 Z M170.666667,341.333333 L213.333333,341.333333 L213.333333,384 L170.666667,384 L170.666667,341.333333 Z M85.3333333,0 L128,0 L128,42.6666667 L85.3333333,42.6666667 L85.3333333,0 Z M256,341.333333 L298.666667,341.333333 L298.666667,384 L256,384 L256,341.333333 Z M170.666667,0 L213.333333,0 L213.333333,42.6666667 L170.666667,42.6666667 L170.666667,0 Z M256,0 L298.666667,0 L298.666667,42.6666667 L256,42.6666667 L256,0 Z M341.333333,170.666667 L384,170.666667 L384,213.333333 L341.333333,213.333333 L341.333333,170.666667 Z M0,256 L42.6666667,256 L42.6666667,298.666667 L0,298.666667 L0,256 Z M341.333333,85.3333333 L384,85.3333333 L384,128 L341.333333,128 L341.333333,85.3333333 Z M0,170.666667 L42.6666667,170.666667 L42.6666667,213.333333 L0,213.333333 L0,170.666667 Z M0,85.3333333 L42.6666667,85.3333333 L42.6666667,128 L0,128 L0,85.3333333 Z" id="Combined-Shape"> </path> </g> </g> </g></svg>
                                                            (@document.AiConfidenceScore?.ToString("P0"))
                                                            </span>
                                                    }
                                                </h4>
                                                <p>@(document.Description?.Length > 80 ? document.Description.Substring(0, 80) + "..." : document.Description)</p>
                                                <small class="text-muted">@((document.FileSize / 1024.0 / 1024.0).ToString("F1")) MB • @document.FileType?.ToUpper()</small>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <span class="type-badge type-@document.DocumentType">@document.DocumentType?.Replace("_", " ")</span>
                                    </td>
                                    <td>
                                        <div class="uploader-info">
                                            <strong>@(document.Uploader.FullName ?? @document.Uploader.UserName)</strong>
                                            <br />
                                            <small class="text-muted">@document.Uploader.University?.Name</small>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="course-info">
                                            <strong>@document.Course.CourseName</strong>
                                            <br />
                                            <small class="text-muted">@document.Course.CourseCode</small>
                                        </div>
                                        @if (document.IsAiGenerated)
                                        {
                                            <span class="meta-item ai-tag">🤖 AI Generated</span>
                                        }
                                    </td>
                                    <td>
                                        <span class="status-badge status-@document.Status">@document.Status</span>
                                        @if (!string.IsNullOrEmpty(document.RejectionReason))
                                        {
                                            <br />
                                            <small class="text-danger" title="@document.RejectionReason">⚠️ Rejected</small>
                                        }
                                    </td>
                                    <td>
                                        <div class="date-info">
                                            <strong>@document.CreatedAt.ToString("MMM dd, yyyy")</strong>
                                            <br />
                                            <small class="text-muted">@document.CreatedAt.ToString("HH:mm")</small>
                                            @if (document.ApprovedAt.HasValue)
                                            {
                                                <br />
                                                <small class="text-success">Approved: @document.ApprovedAt.Value.ToString("MMM dd")</small>
                                            }
                                        </div>
                                    </td>
                                    <td>
                                        <div class="stats-cell">
                                            <div class="stat-item">
                                                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <circle cx="12" cy="12" r="3" stroke="#33363F" stroke-width="2"></circle> <path d="M20.188 10.9343C20.5762 11.4056 20.7703 11.6412 20.7703 12C20.7703 12.3588 20.5762 12.5944 20.188 13.0657C18.7679 14.7899 15.6357 18 12 18C8.36427 18 5.23206 14.7899 3.81197 13.0657C3.42381 12.5944 3.22973 12.3588 3.22973 12C3.22973 11.6412 3.42381 11.4056 3.81197 10.9343C5.23206 9.21014 8.36427 6 12 6C15.6357 6 18.7679 9.21014 20.188 10.9343Z" stroke="#33363F" stroke-width="2"></path> </g></svg>
                                                @document.ViewCount views
                                            </div>
                                            <div class="stat-item">
                                                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path opacity="0.5" d="M3 15C3 17.8284 3 19.2426 3.87868 20.1213C4.75736 21 6.17157 21 9 21H15C17.8284 21 19.2426 21 20.1213 20.1213C21 19.2426 21 17.8284 21 15" stroke="#303030" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M12 3V16M12 16L16 11.625M12 16L8 11.625" stroke="#303030" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
                                                @document.DownloadCount downloads
                                            </div>
                                            <div class="stat-item">
                                                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M7.99997 20H17.1919C17.9865 20 18.7058 19.5296 19.0243 18.8016L21.8323 12.3833C21.9429 12.1305 22 11.8576 22 11.5816V11C22 9.89543 21.1045 9 20 9H13.5L14.7066 4.5757C14.8772 3.95023 14.5826 3.2913 14.0027 3.00136V3.00136C13.4204 2.7102 12.7134 2.87256 12.3164 3.3886L8.41472 8.46082C8.14579 8.81044 7.99997 9.23915 7.99997 9.68024V20ZM7.99997 20H2V10H7.99997V20Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
                                                @document.LikeCount likes
                                            </div>
                                            @if (document.PointsAwarded > 0)
                                            {
                                                <div class="stat-item">
                                                    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M12 3L12.4892 2.12785C12.1854 1.95738 11.8146 1.95738 11.5108 2.12785L12 3ZM13.3976 3.784L12.9084 4.65615C13.0542 4.73792 13.2181 4.78185 13.3852 4.78392L13.3976 3.784ZM15 3.80385L15.8598 3.29316C15.6818 2.99359 15.3608 2.80824 15.0124 2.80392L15 3.80385ZM15.8184 5.18162L14.9586 5.69231C15.044 5.83601 15.164 5.95603 15.3077 6.04139L15.8184 5.18162ZM17.1962 6L18.1961 5.98761C18.1918 5.63921 18.0064 5.31817 17.7068 5.14023L17.1962 6ZM17.216 7.60238L16.2161 7.61476C16.2181 7.78189 16.2621 7.94584 16.3438 8.09161L17.216 7.60238ZM18 9L18.8722 9.48924C19.0426 9.18535 19.0426 8.81465 18.8722 8.51076L18 9ZM17.216 10.3976L16.3438 9.90839C16.2621 10.0542 16.2181 10.2181 16.2161 10.3852L17.216 10.3976ZM17.1962 12L17.7068 12.8598C18.0064 12.6818 18.1918 12.3608 18.1961 12.0124L17.1962 12ZM15.8184 12.8184L15.3077 11.9586C15.164 12.044 15.044 12.164 14.9586 12.3077L15.8184 12.8184ZM15 14.1962L15.0124 15.1961C15.3608 15.1918 15.6818 15.0064 15.8598 14.7068L15 14.1962ZM13.3976 14.216L13.3852 13.2161C13.2181 13.2181 13.0542 13.2621 12.9084 13.3438L13.3976 14.216ZM12 15L11.5108 15.8722C11.8146 16.0426 12.1854 16.0426 12.4892 15.8722L12 15ZM10.6024 14.216L11.0916 13.3438C10.9458 13.2621 10.7819 13.2181 10.6148 13.2161L10.6024 14.216ZM9 14.1962L8.14023 14.7068C8.31817 15.0064 8.63921 15.1918 8.98761 15.1961L9 14.1962ZM8.18162 12.8184L9.04139 12.3077C8.95603 12.164 8.83602 12.044 8.69231 11.9586L8.18162 12.8184ZM6.80385 12L5.80392 12.0124C5.80824 12.3608 5.99359 12.6818 6.29316 12.8598L6.80385 12ZM6.784 10.3976L7.78392 10.3852C7.78185 10.2181 7.73792 10.0542 7.65615 9.90839L6.784 10.3976ZM6 9L5.12785 8.51076C4.95738 8.81465 4.95738 9.18535 5.12785 9.48924L6 9ZM6.784 7.60238L7.65615 8.09161C7.73792 7.94584 7.78185 7.78189 7.78392 7.61476L6.784 7.60238ZM6.80385 6L6.29316 5.14023C5.99359 5.31817 5.80824 5.63921 5.80392 5.98762L6.80385 6ZM8.18162 5.18162L8.69231 6.04139C8.83602 5.95603 8.95603 5.83602 9.04139 5.69231L8.18162 5.18162ZM9 3.80385L8.98762 2.80392C8.63921 2.80824 8.31817 2.99359 8.14023 3.29316L9 3.80385ZM10.6024 3.784L10.6148 4.78392C10.7819 4.78185 10.9458 4.73792 11.0916 4.65615L10.6024 3.784ZM8.5 21H7.5C7.5 21.3565 7.68976 21.686 7.99807 21.8649C8.30639 22.0438 8.68664 22.0451 8.99614 21.8682L8.5 21ZM12 19L12.4961 18.1318C12.1887 17.9561 11.8113 17.9561 11.5039 18.1318L12 19ZM15.5 21L15.0039 21.8682C15.3134 22.0451 15.6936 22.0438 16.0019 21.8649C16.3102 21.686 16.5 21.3565 16.5 21H15.5ZM11.5108 3.87215L12.9084 4.65615L13.8869 2.91185L12.4892 2.12785L11.5108 3.87215ZM13.3852 4.78392L14.9876 4.80377L15.0124 2.80392L13.41 2.78408L13.3852 4.78392ZM14.1402 4.31454L14.9586 5.69231L16.6781 4.67094L15.8598 3.29316L14.1402 4.31454ZM15.3077 6.04139L16.6855 6.85977L17.7068 5.14023L16.3291 4.32186L15.3077 6.04139ZM16.1962 6.01239L16.2161 7.61476L18.2159 7.58999L18.1961 5.98761L16.1962 6.01239ZM16.3438 8.09161L17.1278 9.48924L18.8722 8.51076L18.0882 7.11314L16.3438 8.09161ZM17.1278 8.51076L16.3438 9.90839L18.0882 10.8869L18.8722 9.48924L17.1278 8.51076ZM16.2161 10.3852L16.1962 11.9876L18.1961 12.0124L18.2159 10.41L16.2161 10.3852ZM14.9876 13.1962L13.3852 13.2161L13.41 15.2159L15.0124 15.1961L14.9876 13.1962ZM10.6148 13.2161L9.01239 13.1962L8.98761 15.1961L10.59 15.2159L10.6148 13.2161ZM7.80377 11.9876L7.78392 10.3852L5.78408 10.41L5.80392 12.0124L7.80377 11.9876ZM7.65615 9.90839L6.87215 8.51076L5.12785 9.48924L5.91185 10.8869L7.65615 9.90839ZM6.87215 9.48924L7.65615 8.09161L5.91185 7.11314L5.12785 8.51076L6.87215 9.48924ZM7.78392 7.61476L7.80377 6.01238L5.80392 5.98762L5.78408 7.58999L7.78392 7.61476ZM7.31454 6.85977L8.69231 6.04139L7.67094 4.32186L6.29316 5.14023L7.31454 6.85977ZM9.04139 5.69231L9.85977 4.31454L8.14023 3.29316L7.32186 4.67094L9.04139 5.69231ZM9.01238 4.80377L10.6148 4.78392L10.59 2.78408L8.98762 2.80392L9.01238 4.80377ZM11.0916 4.65615L12.4892 3.87215L11.5108 2.12785L10.1131 2.91185L11.0916 4.65615ZM16.6855 11.1402L15.3077 11.9586L16.3291 13.6781L17.7068 12.8598L16.6855 11.1402ZM8.69231 11.9586L7.31454 11.1402L6.29316 12.8598L7.67094 13.6781L8.69231 11.9586ZM12.9084 13.3438L11.5108 14.1278L12.4892 15.8722L13.8869 15.0882L12.9084 13.3438ZM12.4892 14.1278L11.0916 13.3438L10.1131 15.0882L11.5108 15.8722L12.4892 14.1278ZM8.99614 21.8682L12.4961 19.8682L11.5039 18.1318L8.00386 20.1318L8.99614 21.8682ZM11.5039 19.8682L15.0039 21.8682L15.9961 20.1318L12.4961 18.1318L11.5039 19.8682ZM16.5 21V13.3544H14.5V21H16.5ZM14.9586 12.3077L14.6402 12.8437L16.3598 13.8651L16.6781 13.3291L14.9586 12.3077ZM14.6402 12.8437L14.1402 13.6855L15.8598 14.7068L16.3598 13.8651L14.6402 12.8437ZM7.5 13.3544V21H9.5V13.3544H7.5ZM9.85977 13.6855L9.35977 12.8437L7.64023 13.8651L8.14023 14.7068L9.85977 13.6855ZM9.35977 12.8437L9.04139 12.3077L7.32186 13.3291L7.64023 13.8651L9.35977 12.8437ZM13 9C13 9.55228 12.5523 10 12 10V12C13.6569 12 15 10.6569 15 9H13ZM12 10C11.4477 10 11 9.55228 11 9H9C9 10.6569 10.3431 12 12 12V10ZM11 9C11 8.44772 11.4477 8 12 8V6C10.3431 6 9 7.34315 9 9H11ZM12 8C12.5523 8 13 8.44772 13 9H15C15 7.34315 13.6569 6 12 6V8Z" fill="#000000"></path> </g></svg>
                                                    @document.PointsAwarded pts awarded
                                                </div>
                                            }
                                        </div>
                                    </td>
                                    <td>
                                        <div class="actions-cell">
                                            <a href="@Url.Action("Details", "Documents", new { id = document.DocumentId })" 
                                               class="btn btn-sm btn-outline" title="View Details">
                                                View
                                            </a>
                                            @if (document.Status == "pending")
                                            {
                                                <form asp-action="ApproveDocument" method="post" style="display: inline;">
                                                    <input type="hidden" name="id" value="@document.DocumentId" />
                                                    <button type="submit" class="btn btn-sm btn-success" title="Approve Document"
                                                           onclick="return confirm('Are you sure you want to approve this document?')">
                                                        ✓ Approve
                                                    </button>
                                                </form>
                                                <button class="btn btn-sm btn-danger" title="Reject Document"
                                                        onclick="showRejectModal(@document.DocumentId, '@document.Title')">
                                                    ✗ Reject
                                                </button>
                                            }
                                            <button class="btn btn-sm btn-danger" 
                                                    onclick="deleteDocument(@document.DocumentId, '@document.Title')" 
                                                    title="Delete Document">
                                                 <svg version="1.0" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 64 64" width="16" height="16" enable-background="new 0 0 64 64" xml:space="preserve" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path fill="#ffffff" d="M56,4H40c0-2.211-1.789-4-4-4h-8c-2.211,0-4,1.789-4,4H8C5.789,4,4,5.789,4,8v5c0,0.553,0.447,1,1,1h54 c0.553,0,1-0.447,1-1V8C60,5.789,58.211,4,56,4z"></path> <path fill="#ffffff" d="M20,24c-0.553,0-1,0.447-1,1v26c0,0.553,0.447,1,1,1s1-0.447,1-1V25C21,24.447,20.553,24,20,24z"></path> <path fill="#ffffff" d="M32,24c-0.553,0-1,0.447-1,1v26c0,0.553,0.447,1,1,1s1-0.447,1-1V25C33,24.447,32.553,24,32,24z"></path> <path fill="#ffffff" d="M44,24c-0.553,0-1,0.447-1,1v26c0,0.553,0.447,1,1,1s1-0.447,1-1V25C45,24.447,44.553,24,44,24z"></path> <path fill="#ffffff" d="M9,16H7v44c0,2.211,1.789,4,4,4h42c2.211,0,4-1.789,4-4V16h-2H9z M23,51c0,1.657-1.343,3-3,3s-3-1.343-3-3 V25c0-1.657,1.343-3,3-3s3,1.343,3,3V51z M35,51c0,1.657-1.343,3-3,3s-3-1.343-3-3V25c0-1.657,1.343-3,3-3s3,1.343,3,3V51z M47,51 c0,1.657-1.343,3-3,3s-3-1.343-3-3V25c0-1.657,1.343-3,3-3s3,1.343,3,3V51z"></path> </g> </g></svg>
                                                    Delete
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
                else
                {
                    <div class="empty-state">
                        <div class="empty-icon">
                            <svg viewBox="0 0 24 24" width="24" height="24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M8 12H9M16 12H12" stroke="#000000" stroke-width="1.5" stroke-linecap="round"></path> <path d="M16 8H15M12 8H8" stroke="#000000" stroke-width="1.5" stroke-linecap="round"></path> <path d="M8 16H13" stroke="#000000" stroke-width="1.5" stroke-linecap="round"></path> <path d="M3 14V10C3 6.22876 3 4.34315 4.17157 3.17157C5.34315 2 7.22876 2 11 2H13C16.7712 2 18.6569 2 19.8284 3.17157C20.4816 3.82476 20.7706 4.69989 20.8985 6M21 10V14C21 17.7712 21 19.6569 19.8284 20.8284C18.6569 22 16.7712 22 13 22H11C7.22876 22 5.34315 22 4.17157 20.8284C3.51839 20.1752 3.22937 19.3001 3.10149 18" stroke="#000000" stroke-width="1.5" stroke-linecap="round"></path> </g></svg>
                        </div>
                        <h3>No documents found</h3>
                        <p>@(string.IsNullOrEmpty(ViewBag.SearchTerm?.ToString()) ? "No documents have been uploaded yet." : "Try adjusting your search criteria.")</p>
                        <a href="@Url.Action("Create", "Documents")" class="btn btn-primary" style="margin-top: 20px;">
                            Add First Document
                        </a>
                    </div>
                }
            </div>

            <!-- Pagination -->
            @if (Model.TotalPages > 1)
            {
                <div class="pagination">
                    @if (Model.CurrentPage > 1)
                    {
                        <a href="@Url.Action("DocumentManagement", new { 
                            search = ViewBag.SearchTerm, 
                            status = ViewBag.StatusFilter, 
                            type = ViewBag.TypeFilter,
                            course = ViewBag.CourseFilter,
                            uploader = ViewBag.UploaderFilter,
                            sortBy = ViewBag.SortBy, 
                            sortOrder = ViewBag.SortOrder, 
                            page = Model.CurrentPage - 1 
                        })" class="pagination-btn">Previous</a>
                    }

                    @for (int i = Math.Max(1, Model.CurrentPage - 3); i <= Math.Min(Model.TotalPages, Model.CurrentPage + 3); i++)
                    {
                        <a href="@Url.Action("DocumentManagement", new { 
                            search = ViewBag.SearchTerm, 
                            status = ViewBag.StatusFilter, 
                            type = ViewBag.TypeFilter,
                            course = ViewBag.CourseFilter,
                            uploader = ViewBag.UploaderFilter,
                            sortBy = ViewBag.SortBy, 
                            sortOrder = ViewBag.SortOrder, 
                            page = i 
                        })" class="pagination-btn @(i == Model.CurrentPage ? "active" : "")">@i</a>
                    }

                    @if (Model.CurrentPage < Model.TotalPages)
                    {
                        <a href="@Url.Action("DocumentManagement", new { 
                            search = ViewBag.SearchTerm, 
                            status = ViewBag.StatusFilter, 
                            type = ViewBag.TypeFilter,
                            course = ViewBag.CourseFilter,
                            uploader = ViewBag.UploaderFilter,
                            sortBy = ViewBag.SortBy, 
                            sortOrder = ViewBag.SortOrder, 
                            page = Model.CurrentPage + 1 
                        })" class="pagination-btn">Next</a>
                    }
                </div>
            }
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>Confirm Delete</h3>
            <p>Are you sure you want to delete "<span id="documentTitle"></span>"?</p>
            <p class="text-danger"><strong>This action cannot be undone.</strong></p>
            <div class="modal-actions">
                <button class="btn btn-outline" onclick="closeDeleteModal()">Cancel</button>
                <button class="btn btn-danger" id="confirmDeleteBtn">Delete</button>
            </div>
        </div>
    </div>

    <!-- Reject Modal -->
    <div id="rejectModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>Reject Document</h3>
            <p>Are you sure you want to reject "<span id="rejectDocumentTitle"></span>"?</p>
            <div class="form-group">
                <label for="rejectionReason">Rejection Reason (optional):</label>
                <textarea id="rejectionReason" name="rejectionReason" class="form-control" rows="3" 
                          placeholder="Provide a reason for rejection..."></textarea>
            </div>
            <div class="modal-actions">
                <button class="btn btn-outline" onclick="closeRejectModal()">Cancel</button>
                <button class="btn btn-danger" id="confirmRejectBtn">Reject</button>
            </div>
        </div>
    </div>
    
    <script src="~/js/Admin/DocumentManagement.js" asp-append-version="true"></script>
</body>
</html>