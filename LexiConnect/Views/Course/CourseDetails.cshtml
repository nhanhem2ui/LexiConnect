@{
    Layout = "_Layout";
    ViewData["Title"] = "Course Details";
}
@model LexiConnect.Models.ViewModels.CourseDetailsViewModel

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@Model.Course.CourseName - LexiConnect</title>
    <link rel="stylesheet" href="~/css/Course/CourseDetail.css" />
    <link rel="stylesheet" href="~/css/Home/Homepage.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
</head>

<body>
    <div class="dashboard-container">
        <partial name="_Sidebar" />

        <!-- Main Content -->
        <div class="main-content">
            <!-- Breadcrumb Navigation -->
            <nav class="breadcrumb">
                <a href="@Url.Action("Index", "Home")">University</a>
                <span class="separator">›</span>
                <a href="@Url.Action("MajorCourses", "Home", new { majorId = Model.Course.MajorId })">@Model.Course.Major.Name</a>
                <span class="separator">›</span>
                <span class="current">@Model.Course.CourseName</span>
            </nav>

            <!-- Course Header -->
            <div class="course-header">
                <div class="course-icon">
                    <svg viewBox="0 0 24 24" width="48" height="48" fill="white">
                        <path d="M12 3L1 9L5 11.18V17.18L12 21L19 17.18V11.18L21 10.09V17H23V9L12 3ZM18.82 9L12 12.72L5.18 9L12 5.28L18.82 9ZM17 15.99L12 18.72L7 15.99V12.27L12 15L17 12.27V15.99Z" />
                    </svg>
                </div>
                <div class="course-info">
                    <h1>@Model.Course.CourseName <span class="course-code">(@Model.Course.CourseCode)</span></h1>
                    <div class="course-meta">
                        <span class="meta-item">
                            <svg viewBox="0 0 24 24" width="16" height="16">
                                <path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19Z" />
                            </svg>
                            @Model.TotalDocuments documents
                        </span>
                        <span class="meta-item">
                            <svg viewBox="0 0 24 24" width="16" height="16">
                                <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z" />
                            </svg>
                            @Model.TotalQuestions questions
                        </span>
                        <span class="meta-item">
                            <svg viewBox="0 0 24 24" width="16" height="16">
                                <path d="M15 12C17.21 12 19 10.21 19 8C19 5.79 17.21 4 15 4C12.79 4 11 5.79 11 8C11 10.21 12.79 12 15 12ZM15 14C12.33 14 7 15.34 7 18V20H23V18C23 15.34 17.67 14 15 14ZM6 10V7H4V10H1V12H4V15H6V12H9V10H6Z" />
                            </svg>
                            @Model.TotalStudents students
                        </span>
                        @if (Model.Course.Semester.HasValue)
                        {
                            <span class="meta-item">Semester @Model.Course.Semester</span>
                        }
                        @if (Model.Course.AcademicYear.HasValue)
                        {
                            <span class="meta-item">@Model.Course.AcademicYear</span>
                        }
                    </div>
                    @if (!string.IsNullOrEmpty(Model.Course.Description))
                    {
                        <p class="course-description">@Model.Course.Description</p>
                    }
                </div>
                <div class="course-actions">
                    <button class="btn-follow @(Model.IsFollowing ? "following" : "")" id="followBtn">
                        <svg viewBox="0 0 24 24" width="20" height="20">
                            <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.04L12 21.35Z" />
                        </svg>
                        @(Model.IsFollowing ? "Following" : "Follow")
                    </button>
                    <button class="btn-summarize">
                        <svg viewBox="0 0 24 24" width="20" height="20">
                            <path d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V8L14 2ZM16 18H8V16H16V18ZM16 14H8V12H16V14ZM13 9V3.5L18.5 9H13Z" />
                        </svg>
                        Summarize notes
                    </button>
                    <button class="btn-share">
                        <svg viewBox="0 0 24 24" width="20" height="20">
                            <path d="M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12C9 11.76 8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5C21 3.34 19.66 2 18 2C16.34 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12C3 13.66 4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.35C15.11 18.56 15.08 18.78 15.08 19C15.08 20.61 16.39 21.92 18 21.92C19.61 21.92 20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08Z" />
                        </svg>
                        Share
                    </button>
                </div>
            </div>

            <!-- Search Bar -->
            <div class="search-bar-container">
                <div class="search-wrapper">
                    <svg viewBox="0 0 24 24" width="20" height="20" class="search-icon">
                        <path d="M15.5 14H14.71L14.43 13.73C15.41 12.59 16 11.11 16 9.5C16 5.91 13.09 3 9.5 3C5.91 3 3 5.91 3 9.5C3 13.09 5.91 16 9.5 16C11.11 16 12.59 15.41 13.73 14.43L14 14.71V15.5L19 20.49L20.49 19L15.5 14ZM9.5 14C7.01 14 5 11.99 5 9.5C5 7.01 7.01 5 9.5 5C11.99 5 14 7.01 14 9.5C14 11.99 11.99 14 9.5 14Z" />
                    </svg>
                    <input type="text" placeholder="Find in @Model.Course.CourseName" class="search-input" />
                </div>
            </div>

            <!-- Trending Section -->
            <div class="trending-section">
                <div class="section-header">
                    <h2>
                        <svg viewBox="0 0 24 24" width="24" height="24">
                            <path d="M16 6L18.29 8.29L13.41 13.17L9.41 9.17L2 16.59L3.41 18L9.41 12L13.41 16L19.71 9.71L22 12V6H16Z" />
                        </svg>
                        Trending
                    </h2>
                    <div class="section-controls">
                        <button class="scroll-btn prev" id="trendingPrev">
                            <svg viewBox="0 0 24 24" width="20" height="20">
                                <path d="M15.41 7.41L14 6L8 12L14 18L15.41 16.59L10.83 12L15.41 7.41Z" />
                            </svg>
                        </button>
                        <button class="scroll-btn next" id="trendingNext">
                            <svg viewBox="0 0 24 24" width="20" height="20">
                                <path d="M8.59 16.59L10 18L16 12L10 6L8.59 7.41L13.17 12L8.59 16.59Z" />
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="top-documents" id="trendingGrid">
                    @foreach (var doc in Model.TrendingDocuments)
                    {
                        <div class="top-document-card"
                             onclick="location.href='@Url.Action("DetailDocument", "Document", new { id = doc.DocumentId })'">
                            <div class="document-preview">
                                <div class="document-preview-title">
                                    @doc.Title
                                </div>
                            </div>
                            <h3 class="document-title">@(string.IsNullOrEmpty(doc.Description) ? doc.Title : doc.Description)</h3>

                            @if (doc.DownloadCount > 0)
                            {
                                <span class="stats-divider"></span>
                                <span>⬇️ @doc.DownloadCount</span>
                            }

                            <div class="completion-badge">
                                <i class="bi bi-heart-fill"></i>
                                <span class="completion-percentage">@doc.LikeCount likes</span>
                            </div>
                        </div>
                    }
                </div>
            </div>

            <!-- Document Types Section -->
            <div class="document-types-section">
                <div class="section-header">
                    <h2>
                        <svg viewBox="0 0 24 24" width="24" height="24">
                            <path d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z" />
                        </svg>
                        Lecture notes
                    </h2>
                    <div class="sort-controls">
                        <button class="sort-btn @(Model.CurrentSort == "date" ? "active" : "")" data-sort="date">
                            <svg viewBox="0 0 24 24" width="16" height="16">
                                <path d="M19 3H18V1H16V3H8V1H6V3H5C3.89 3 3 3.9 3 5V19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V8H19V19Z" />
                            </svg>
                            Date
                        </button>
                        <button class="sort-btn @(Model.CurrentSort == "rating" ? "active" : "")" data-sort="rating">
                            <svg viewBox="0 0 24 24" width="16" height="16">
                                <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z" />
                            </svg>
                            Rating
                        </button>
                        <div class="view-toggle">
                            <button class="view-btn active" data-view="grid">
                                <svg viewBox="0 0 24 24" width="16" height="16">
                                    <path d="M4 11H10V5H4V11ZM14 5V11H20V5H14ZM14 19H20V13H14V19ZM4 19H10V13H4V19Z" />
                                </svg>
                            </button>
                            <button class="view-btn" data-view="list">
                                <svg viewBox="0 0 24 24" width="16" height="16">
                                    <path d="M3 13H5V11H3V13ZM3 17H5V15H3V17ZM3 9H5V7H3V9ZM7 13H21V11H7V13ZM7 17H21V15H7V17ZM7 7V9H21V7H7Z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="top-documents" id="documentsList">
                    @foreach (var doc in Model.LectureNotes)
                    {
                        <div class="top-document-card"
                             onclick="location.href='@Url.Action("DetailDocument", "Document", new { id = doc.DocumentId })'">
                            <div class="document-preview">
                                <div class="document-preview-title">
                                    @doc.Title
                                </div>
                            </div>
                            <h3 class="document-title">@(string.IsNullOrEmpty(doc.Description) ? doc.Title : doc.Description)</h3>

                            @if (doc.DownloadCount > 0)
                            {
                                <span class="stats-divider"></span>
                                <span>⬇️ @doc.DownloadCount</span>
                            }

                            <div class="completion-badge">
                                <i class="bi bi-heart-fill"></i>
                                <span class="completion-percentage">@doc.LikeCount likes</span>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <form asp-antiforgery="true"></form>
    <script src="~/js/Course/CourseDetail.js"></script>
</body>
</html>