@{
    Layout = "_Layout";
    ViewData["Title"] = "Reset Password";
}
@model LexiConnect.Models.ViewModels.ResetPasswordViewModel

<!DOCTYPE html>
<html lang="en">
<head>
    <title>LexiConnect - Reset Password</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="~/css/Auth/ResetPassword.css"/>
</head>

<body>
    <!-- Main Content -->
    <div class="main-content">
        <div class="content-wrapper">
            <!-- Left Section -->
            <div class="left-section">
                <h1>LexiConnect</h1>
                <p>Access to thousands of academic resources</p>

                <!-- Geometric Design -->
                <div class="geometric-design">
                    <svg viewBox="0 0 280 200" xmlns="http://www.w3.org/2000/svg">
                        <!-- Main geometric shapes -->
                        <circle cx="40" cy="40" r="20" fill="none" stroke="white" stroke-width="2" />

                        <!-- Complex polygon shape -->
                        <polygon points="80,60 140,40 180,80 160,140 100,160 60,120"
                                 fill="none" stroke="white" stroke-width="2" />

                        <!-- Triangular shapes -->
                        <polygon points="180,100 240,80 220,140"
                                 fill="none" stroke="white" stroke-width="2" />

                        <!-- Additional circle -->
                        <circle cx="240" cy="160" r="25" fill="none" stroke="white" stroke-width="2" />

                        <!-- Connecting lines -->
                        <line x1="60" y1="60" x2="80" y2="80" stroke="white" stroke-width="2" />
                        <line x1="140" y1="140" x2="180" y2="120" stroke="white" stroke-width="2" />

                        <!-- Bottom dashed lines -->
                        <line x1="20" y1="180" x2="40" y2="180" stroke="white" stroke-width="3" />
                        <line x1="50" y1="180" x2="70" y2="180" stroke="white" stroke-width="3" />
                        <line x1="80" y1="180" x2="100" y2="180" stroke="white" stroke-width="3" />
                        <line x1="110" y1="180" x2="130" y2="180" stroke="white" stroke-width="3" />

                        <!-- Small dots -->
                        <circle cx="160" cy="180" r="2" fill="white" />
                        <circle cx="170" cy="180" r="2" fill="white" />
                        <circle cx="180" cy="180" r="2" fill="white" />
                    </svg>
                </div>
            </div>

            <!-- Reset Password Card -->
            <div class="reset-password-card">
                <h2>Reset Password</h2>
                <p class="subtitle">Please enter your new password below. Make sure it's strong and secure.</p>

                <!-- Display success message if password was reset -->
                @if (ViewBag.PasswordReset == true)
                {
                    <div class="success-message">
                        <p>Your password has been successfully reset! You can now sign in with your new password.</p>
                    </div>

                    <div class="back-to-signin">
                        <a href="@Url.Action("Signin", "Auth")">Go to Sign In</a>
                    </div>
                }
                else
                {
                    <!-- Display validation summary for general errors -->
                    @if (!ViewData.ModelState.IsValid)
                    {
                        <div class="validation-summary">
                            <ul>
                                @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
                                {
                                    <li>@error.ErrorMessage</li>
                                }
                            </ul>
                        </div>
                    }

                    <form class="reset-password-form" asp-action="ResetPassword" asp-controller="Auth" method="post" id="resetPasswordForm">
                        @Html.AntiForgeryToken()

                        <!-- Hidden fields for UserId and Code -->
                        <input type="hidden" name="UserId" value="@Model.UserId" />
                        <input type="hidden" name="Code" value="@Model.Code" />

                        <div class="form-group">
                            <label for="newPassword">New Password</label>
                            <div class="password-input">
                                <input type="password" asp-for="NewPassword" id="newPassword" name="newPassword" placeholder="Enter new password" required>
                                <button type="button" class="password-toggle" onclick="togglePassword('newPassword', this)">
                                    <span class="toggle-text">Show</span>
                                </button>
                            </div>
                            <div class="password-strength" id="passwordStrength">
                                <div class="strength-bar">
                                    <div class="strength-fill" id="strengthFill"></div>
                                </div>
                                <div class="strength-text" id="strengthText">Password strength</div>
                            </div>
                            <div class="password-requirements">
                                <ul id="requirements">
                                    <li id="length">At least 6 characters</li>
                                    <li id="uppercase">One uppercase letter</li>
                                    <li id="lowercase">One lowercase letter</li>
                                    <li id="number">One number</li>
                                    <li id="special">One special character</li>
                                </ul>
                            </div>
                            <span class="field-validation-error"></span>
                        </div>

                        <div class="form-group">
                            <label for="confirmPassword">Confirm New Password</label>
                            <div class="password-input">
                                <input type="password" asp-for="ConfirmPassword" id="confirmPassword" name="confirmPassword" placeholder="Confirm new password" required>
                                <button type="button" class="password-toggle" onclick="togglePassword('confirmPassword', this)">
                                    <span class="toggle-text">Show</span>
                                </button>
                            </div>
                            <span class="field-validation-error"></span>
                        </div>

                        <button type="submit" class="reset-btn" id="resetBtn">
                            <span class="btn-text"><b>Reset Password</b></span>
                        </button>

                        <div class="back-to-signin">
                            Remember your password? <a href="@Url.Action("Signin", "Auth")">Back to Sign In</a>
                        </div>
                    </form>
                }
            </div>
        </div>
    </div>

    <script src="~/js/Auth/ResetPassword.js" asp-append-version="true"></script>
</body>
</html>